<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Loan Predictor - Explainable AI Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-brain"></i>
                <span>AI Loan Predictor</span>
            </div>
            <div class="nav-menu">
                <button class="nav-btn active" data-tab="prediction">
                    <i class="fas fa-calculator"></i>
                    Prediction
                </button>
               
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Prediction Tab -->
        <div id="prediction-tab" class="tab-content active">
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="gradient-text">AI-Powered</span> Loan Approval
                    </h1>
                    <p class="hero-subtitle">
                        Get instant loan approval predictions with transparent AI explanations
                    </p>
                </div>
            </div>

            <div class="container">
                <div class="prediction-grid">
                    <!-- Application Form -->
                    <div class="form-card">
                        <div class="card-header">
                            <h2>
                                <i class="fas fa-file-alt"></i>
                                Loan Application
                            </h2>
                            <p>Fill out your details for AI-powered loan assessment</p>
                        </div>

                        <form id="loan-form" class="loan-form">
                            <div class="form-section">
                                <h3>Personal Information</h3>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="gender">Gender</label>
                                        <select id="gender" name="Gender" required>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="married">Marital Status</label>
                                        <select id="married" name="Married" required>
                                            <option value="Yes">Married</option>
                                            <option value="No">Single</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dependents">Dependents</label>
                                        <select id="dependents" name="Dependents" required>
                                            <option value="0">0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3+">3+</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="education">Education</label>
                                        <select id="education" name="Education" required>
                                            <option value="Graduate">Graduate</option>
                                            <option value="Not Graduate">Not Graduate</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>Employment & Financial Details</h3>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="self-employed">Employment Type</label>
                                        <select id="self-employed" name="Self_Employed" required>
                                            <option value="No">Employed</option>
                                            <option value="Yes">Self Employed</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="applicant-income">Your Income (₹/month)</label>
                                        <input type="number" id="applicant-income" name="ApplicantIncome" 
                                               value="5000" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="coapplicant-income">Co-applicant Income (₹/month)</label>
                                        <input type="number" id="coapplicant-income" name="CoapplicantIncome" 
                                               value="0" min="0" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="property-area">Property Area</label>
                                        <select id="property-area" name="Property_Area" required>
                                            <option value="Urban">Urban</option>
                                            <option value="Semiurban">Semi-urban</option>
                                            <option value="Rural">Rural</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3>Loan Details</h3>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="loan-amount">Loan Amount (₹ thousands)</label>
                                        <input type="number" id="loan-amount" name="LoanAmount" 
                                               value="150" min="1" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="loan-term">Loan Term (months)</label>
                                        <select id="loan-term" name="Loan_Amount_Term" required>
                                            <option value="120">120 (10 years)</option>
                                            <option value="180">180 (15 years)</option>
                                            <option value="240">240 (20 years)</option>
                                            <option value="300">300 (25 years)</option>
                                            <option value="360" selected>360 (30 years)</option>
                                            <option value="480">480 (40 years)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="credit-history">Credit History</label>
                                        <select id="credit-history" name="Credit_History" required>
                                            <option value="1">Good Credit History</option>
                                            <option value="0">Poor Credit History</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="submit-btn" id="predict-btn">
                                <i class="fas fa-magic"></i>
                                <span>Predict Loan Approval</span>
                                <div class="btn-loader hidden">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                            </button>
                        </form>
                    </div>

                    <!-- Results Panel -->
                    <div class="results-card">
                        <div class="card-header">
                            <h2>
                                <i class="fas fa-chart-line"></i>
                                AI Prediction Results
                            </h2>
                            <p>Transparent AI decision with detailed explanations</p>
                        </div>

                        <div id="results-content" class="results-content">
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <h3>Ready for Prediction</h3>
                                <p>Fill out the loan application form and click "Predict" to see AI-powered results with explanations</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

  <!-- AI Tutor Section -->
<div id="tutorial-tab" class="tab-content">
  <div class="container">
    <div class="tutorial-header">
      <h1>Meet Your AI Loan Assistant</h1>
      <p>Ask questions about loans, approval tips, and AI in simple terms</p>
    </div>

    <!-- Quick Questions -->
    <div class="quick-questions">
      <h3>Try Asking:</h3>
      <ul class="question-list">
        <li onclick="askTutor('What is AI and how does it help with loans?')">What is AI and how does it help with loans?</li>
        <li onclick="askTutor('Why is credit history important?')">Why is credit history important?</li>
        <li onclick="askTutor('How can I improve my chances of loan approval?')">How can I improve my chances of loan approval?</li>
        <li onclick="askTutor('What happens if my loan is rejected?')">What happens if my loan is rejected?</li>
        <li onclick="askTutor('Explain loan amount vs income')">Explain loan amount vs income</li>
      </ul>
    </div>

    <!-- Chat Interface -->
    <div class="chatbox">
      <div id="chat-messages" class="chat-messages">
        <div class="message bot">
          <span class="bot-name">AI Tutor:</span>
          <span class="text">Hi there! I'm your AI tutor. Ask me anything about loans, approvals, or AI!</span>
        </div>
      </div>
      <div class="chat-input">
        <input type="text" id="user-question" placeholder="Type your question here..." onkeypress="if(event.key === 'Enter'){submitQuestion()}" />
        <button onclick="submitQuestion()">Send</button>
      </div>
    </div>
  </div>
</div>

<script>
function askTutor(question) {
  document.getElementById('user-question').value = question;
  submitQuestion();
}

function submitQuestion() {
  const input = document.getElementById('user-question');
  const question = input.value.trim();
  if (!question) return;

  const chatBox = document.getElementById('chat-messages');
  chatBox.innerHTML += `
    <div class="message user">
      <span class="text">${question}</span>
    </div>
  `;
  input.value = '';

  fetch('http://localhost:5000/api/ask', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ question })
  })
    .then(res => res.json())
    .then(data => {
      chatBox.innerHTML += `
        <div class="message bot">
          <span class="bot-name">AI Tutor:</span>
          <span class="text">${data.answer}</span>
        </div>
      `;
      chatBox.scrollTop = chatBox.scrollHeight;
    })
    .catch(() => {
      chatBox.innerHTML += `
        <div class="message bot error">
          <span class="text">Oops! Something went wrong. Try again.</span>
        </div>
      `;
    });
}
</script>

<style>
.chatbox {
  margin-top: 20px;
  background: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 16px;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
}
.chat-messages {
  max-height: 300px;
  overflow-y: auto;
  margin-bottom: 12px;
}
.message {
  margin-bottom: 10px;
  display: flex;
  flex-direction: column;
}
.message.user {
  align-items: flex-end;
  text-align: right;
}
.message.bot {
  align-items: flex-start;
  text-align: left;
}
.message .text {
  padding: 8px 12px;
  background: #e0e7ff;
  border-radius: 8px;
  max-width: 75%;
}
.message.user .text {
  background: #c7d2fe;
  color: #111827;
}
.chat-input {
  display: flex;
  gap: 10px;
}
.chat-input input {
  flex: 1;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
.chat-input button {
  background: #4f46e5;
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 6px;
  cursor: pointer;
}
.chat-input button:hover {
  background: #4338ca;
}
.quick-questions ul {
  padding: 0;
  list-style: none;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin: 20px 0;
}
.quick-questions li {
  background: #eef2ff;
  padding: 10px 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}
.quick-questions li:hover {
  background: #e0e7ff;
}
</style>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 AI Loan Predictor. Powered by Explainable AI Technology.</p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>

<script>
function askTutor(question) {
  document.getElementById('user-question').value = question;
  submitQuestion();
}

function submitQuestion() {
  const input = document.getElementById('user-question');
  const question = input.value.trim();
  if (!question) return;

  const chatBox = document.getElementById('chat-messages');
  chatBox.innerHTML += `
    <div class="message user">
      <span class="text">${question}</span>
    </div>
  `;
  input.value = '';

  fetch('http://localhost:5000/api/ask', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ question })
  })
    .then(res => {
      if (!res.ok) throw new Error("Network error");
      return res.json();
    })
    .then(data => {
      chatBox.innerHTML += `
        <div class="message bot">
          <span class="bot-name">AI Tutor:</span>
          <span class="text">${data.answer}</span>
        </div>
      `;
      chatBox.scrollTop = chatBox.scrollHeight;
    })
    .catch(err => {
  console.error("AI Tutor error:", err);

  const errorMessage = err?.message || "Oops! Something went wrong. Try again later.";

  chatBox.innerHTML += `
    <div class="message bot error">
      <span class="bot-name">AI Tutor:</span>
      <span class="text">${errorMessage}</span>
    </div>
  `;
  chatBox.scrollTop = chatBox.scrollHeight;
});

}
</script>
